# 人間のような思考プロセスを持つLLMシステム

このプロジェクトは、人間のような思考プロセスを模倣した言語モデルシステムを実装しています。主な特徴として、リアルタイムで思考しながら回答を生成する能力や、複数の脳機能を模した並列処理システムを備えています。

## 主な特徴

1. マルチプロセス脳モデル
   - 左脳（論理的思考）と右脳（直感的思考）の並列処理
   - 前頭葉による実行機能と意思決定
   - 海馬モジュールによる記憶の管理
   - 感情処理モジュールによる感情表現

2. 多層記憶システム
   - ワーキングメモリ、短期記憶、長期記憶の階層構造
   - Miller's Law (7±2) に基づく記憶管理
   - 手続き記憶によるパターン認識

3. リアルタイム思考・出力メカニズム
   - 思考完了を待たずに出力開始
   - 不確実性の自然な表現
   - 思考ストリーミング機構

## 使用方法

### 環境構築

```bash
pip install -e .
```

### 知識蒸留の実行

```bash
python main.py distill --teacher_model elyza/ELYZA-Thinking-1.0-Qwen-32B --num_examples 1000
```

### 対話モード

```bash
python main.py chat --model_path ./models/brain_model_best.pt
```

## システム構成

- `brain_model.py`: 脳モデルの実装
- `memory_system.py`: 多層記憶システムの実装
- `real_time_thoughts.py`: リアルタイム思考と出力のメカニズム
- `distillation.py`: 知識蒸留のプロセス
- `inference.py`: 推論エンジン
- `main.py`: コマンドラインインターフェイス

## 技術的詳細

### マルチプロセス脳モデル

システムは複数の並列処理モジュールを持ち、それぞれが異なる役割を担います：

- 左脳モジュール：深い分析と論理的思考
- 右脳モジュール：直感的な反応と創造性
- 前頭葉モジュール：実行機能と最終的な意思決定
- 海馬モジュール：記憶の形成と検索
- 感情モジュール：感情状態の追跡と表現

### 思考プロセス

1. 直感的な第一印象（右脳）
2. 探索的思考（記憶からの関連情報検索）
3. 分析的思考（左脳）
4. ひらめき生成（確率的に発生）
5. 結論の形成（前頭葉）

各段階が非同期に進行し、思考の途中経過をストリーミング出力することで、人間のように「考えながら話す」効果を実現しています。
